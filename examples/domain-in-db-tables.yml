connections:
  docker-mariadb:
    docker.exec:
      container: mariadb
  drupal-db:
    mysql:
      connection: docker-mariadb
      username: drupal
      password: drupal
      database: drupal

collect:
  table-names:
    database.query:
      connection: drupal-db
      query: "SHOW TABLES"
      format: list
  domain-in-tables:
    database.query:
      connection: drupal-db
      input: table_names
      query: "SELECT domain FROM {{ .Item }} WHERE domain LIKE %.example.com%"
      format: map-list

analyse:
  domain-found-in-tables:
    not-empty:
      description: Domain found in table
      input: domain-in-tables

output:
  stdout:
    format: pretty
