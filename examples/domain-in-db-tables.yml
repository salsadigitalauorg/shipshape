connections:
  docker_mariadb:
    docker.exec:
      container: mariadb
  drupal_db:
    mysql:
      connection: docker_mariadb
      username: drupal
      password: drupal
      database: drupal

gather:
  table_names:
    database.query:
      connection: drupal_db
      query: "SHOW TABLES"
      format: list
  domain_in_tables:
    database.query:
      connection: drupal_db
      input: table_names
      query: "SELECT domain FROM {{ .Item }} WHERE domain LIKE %.example.com%"
      format: list

analyse:
  domain_in_tables: {}

output:
  stdout:
    format: pretty
