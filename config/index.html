<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Config | ShipShape</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="Quickly and simply audit your project based on a set of pre-defined rules.">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/shipshape/assets/css/0.styles.ba33bb80.css" as="style"><link rel="preload" href="/shipshape/assets/js/app.70d73435.js" as="script"><link rel="preload" href="/shipshape/assets/js/2.4470ce03.js" as="script"><link rel="preload" href="/shipshape/assets/js/1.185b50a8.js" as="script"><link rel="preload" href="/shipshape/assets/js/25.3a23e82c.js" as="script"><link rel="prefetch" href="/shipshape/assets/js/10.b67bc8a6.js"><link rel="prefetch" href="/shipshape/assets/js/11.0256ff5f.js"><link rel="prefetch" href="/shipshape/assets/js/12.7bdc8d5d.js"><link rel="prefetch" href="/shipshape/assets/js/13.786f62b7.js"><link rel="prefetch" href="/shipshape/assets/js/14.91be0496.js"><link rel="prefetch" href="/shipshape/assets/js/15.3b92efb8.js"><link rel="prefetch" href="/shipshape/assets/js/16.47e1d84d.js"><link rel="prefetch" href="/shipshape/assets/js/17.368b07ea.js"><link rel="prefetch" href="/shipshape/assets/js/18.8241d824.js"><link rel="prefetch" href="/shipshape/assets/js/19.56a0d05b.js"><link rel="prefetch" href="/shipshape/assets/js/20.87ddadca.js"><link rel="prefetch" href="/shipshape/assets/js/21.e21ffad3.js"><link rel="prefetch" href="/shipshape/assets/js/22.b178a08c.js"><link rel="prefetch" href="/shipshape/assets/js/23.dd28ff01.js"><link rel="prefetch" href="/shipshape/assets/js/24.fa2616f0.js"><link rel="prefetch" href="/shipshape/assets/js/26.dd4054ee.js"><link rel="prefetch" href="/shipshape/assets/js/27.12eb34cd.js"><link rel="prefetch" href="/shipshape/assets/js/28.de11431b.js"><link rel="prefetch" href="/shipshape/assets/js/3.8af8fcbf.js"><link rel="prefetch" href="/shipshape/assets/js/4.4c3bd895.js"><link rel="prefetch" href="/shipshape/assets/js/5.842b4107.js"><link rel="prefetch" href="/shipshape/assets/js/6.9f813617.js"><link rel="prefetch" href="/shipshape/assets/js/7.deca3814.js"><link rel="prefetch" href="/shipshape/assets/js/vendors~docsearch.a43fb3db.js">
    <link rel="stylesheet" href="/shipshape/assets/css/0.styles.ba33bb80.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/shipshape/" class="home-link router-link-active"><!----> <span class="site-name">ShipShape</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/shipshape/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/shipshape/config/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Config
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="main" class="dropdown-title"><span class="title">main</span> <span class="arrow down"></span></button> <button type="button" aria-label="main" class="mobile-dropdown-title"><span class="title">main</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://818b00ca-cb1b-4227-99ed-284bd9c399db.quantsites.com/1.x" target="_blank" rel="noopener noreferrer" class="nav-link external">
  1.x
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/salsadigitalauorg/shipshape" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/shipshape/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/shipshape/config/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Config
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="main" class="dropdown-title"><span class="title">main</span> <span class="arrow down"></span></button> <button type="button" aria-label="main" class="mobile-dropdown-title"><span class="title">main</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://818b00ca-cb1b-4227-99ed-284bd9c399db.quantsites.com/1.x" target="_blank" rel="noopener noreferrer" class="nav-link external">
  1.x
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/salsadigitalauorg/shipshape" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Config</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/shipshape/config/#check-types" class="sidebar-link">Check types</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/shipshape/config/#common-fields" class="sidebar-link">Common fields</a></li><li class="sidebar-sub-header"><a href="/shipshape/config/#file" class="sidebar-link">file</a></li><li class="sidebar-sub-header"><a href="/shipshape/config/#filediff" class="sidebar-link">filediff</a></li><li class="sidebar-sub-header"><a href="/shipshape/config/#yaml" class="sidebar-link">yaml</a></li><li class="sidebar-sub-header"><a href="/shipshape/config/#yamllint" class="sidebar-link">yamllint</a></li><li class="sidebar-sub-header"><a href="/shipshape/config/#json" class="sidebar-link">json</a></li><li class="sidebar-sub-header"><a href="/shipshape/config/#crawler" class="sidebar-link">crawler</a></li><li class="sidebar-sub-header"><a href="/shipshape/config/#drush-yaml" class="sidebar-link">drush-yaml</a></li><li class="sidebar-sub-header"><a href="/shipshape/config/#drupal-file-module" class="sidebar-link">drupal-file-module</a></li><li class="sidebar-sub-header"><a href="/shipshape/config/#drupal-db-module" class="sidebar-link">drupal-db-module</a></li><li class="sidebar-sub-header"><a href="/shipshape/config/#drupal-db-permissions" class="sidebar-link">drupal-db-permissions</a></li><li class="sidebar-sub-header"><a href="/shipshape/config/#drupal-role-permissions" class="sidebar-link">drupal-role-permissions</a></li><li class="sidebar-sub-header"><a href="/shipshape/config/#drupal-user-forbidden" class="sidebar-link">drupal-user-forbidden</a></li><li class="sidebar-sub-header"><a href="/shipshape/config/#phpstan" class="sidebar-link">phpstan</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="config"><a href="#config" class="header-anchor">#</a> Config</h1> <p>The basic layout of the config file is as follows:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">project-dir</span><span class="token punctuation">:</span> /path/to/project <span class="token comment"># Default is the current working directory</span>
<span class="token key atrule">fail-severity</span><span class="token punctuation">:</span> high <span class="token comment"># Default is high, other possible values are low, normal, critical</span>
<span class="token key atrule">checks</span><span class="token punctuation">:</span>
  <span class="token punctuation">{</span>check<span class="token punctuation">-</span>type<span class="token punctuation">}</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>check<span class="token punctuation">-</span>name<span class="token punctuation">}</span>
    <span class="token key atrule">severity</span><span class="token punctuation">:</span> normal <span class="token comment"># Only report failures, do not fail</span>
    <span class="token punctuation">...</span> <span class="token comment"># Other check-specific fields.</span>
</code></pre></div><p>Taking the config in the quick-start as an example:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">checks</span><span class="token punctuation">:</span>
  <span class="token key atrule">file</span><span class="token punctuation">:</span> <span class="token comment"># Corresponds to {check-type}</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Illegal files <span class="token comment"># Corresponds to {check-name}</span>
      <span class="token key atrule">path</span><span class="token punctuation">:</span> web
      <span class="token key atrule">disallowed-pattern</span><span class="token punctuation">:</span> <span class="token string">'^(adminer|phpmyadmin|bigdump)?\.php$'</span>
</code></pre></div><h2 id="check-types"><a href="#check-types" class="header-anchor">#</a> Check types</h2> <p>The following check types are available:</p> <ul><li><a href="#file">file</a></li> <li><a href="#filediff">filediff</a></li> <li><a href="#yaml">yaml</a></li> <li><a href="#yamllint">yamllint</a></li> <li><a href="#json">json</a></li> <li><a href="#crawler">crawler</a></li> <li><a href="#drush-yaml">drush-yaml</a></li> <li><a href="#drupal-file-module">drupal-file-module</a></li> <li><a href="#drupal-db-module">drupal-db-module</a></li> <li><a href="#drupal-db-permissions">drupal-db-permissions</a></li> <li><a href="#drupal-role-permissions">drupal-role-permissions</a></li> <li><a href="#drupal-user-forbidden">drupal-user-forbidden</a></li> <li><a href="#phpstan">phpstan</a></li></ul> <h3 id="common-fields"><a href="#common-fields" class="header-anchor">#</a> Common fields</h3> <p>The fields below are common to all checks.</p> <table><thead><tr><th>Field</th> <th style="text-align:center;">Default</th> <th style="text-align:center;">Required</th> <th>Description</th></tr></thead> <tbody><tr><td>name</td> <td style="text-align:center;">-</td> <td style="text-align:center;">Yes</td> <td>The name of the check</td></tr> <tr><td>severity</td> <td style="text-align:center;">normal</td> <td style="text-align:center;">No</td> <td>The severity of the check</td></tr></tbody></table> <h3 id="file"><a href="#file" class="header-anchor">#</a> file</h3> <p>Checks for disallowed files in the specified path using the pattern provided.</p> <table><thead><tr><th>Field</th> <th style="text-align:center;">Default</th> <th style="text-align:center;">Required</th> <th>Description</th></tr></thead> <tbody><tr><td>path</td> <td style="text-align:center;">-</td> <td style="text-align:center;">Yes</td> <td>Path (directory) to check for the presence of files</td></tr> <tr><td>disallowed-pattern</td> <td style="text-align:center;">-</td> <td style="text-align:center;">Yes</td> <td>Regex pattern defining the disallowed files</td></tr></tbody></table> <h4 id="example"><a href="#example" class="header-anchor">#</a> Example</h4> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">file</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Illegal files
    <span class="token key atrule">path</span><span class="token punctuation">:</span> web
    <span class="token key atrule">disallowed-pattern</span><span class="token punctuation">:</span> <span class="token string">'^(adminer|phpmyadmin|bigdump)?\.php$'</span>
</code></pre></div><h3 id="filediff"><a href="#filediff" class="header-anchor">#</a> filediff</h3> <p>Checks for content changes in a file.</p> <table><thead><tr><th>Field</th> <th style="text-align:center;">Default</th> <th style="text-align:center;">Required</th> <th>Description</th></tr></thead> <tbody><tr><td>target-file</td> <td style="text-align:center;">-</td> <td style="text-align:center;">Yes</td> <td>The file to check for content changes</td></tr> <tr><td>source-file</td> <td style="text-align:center;">-</td> <td style="text-align:center;">Yes</td> <td>The file with the original content used for checking. Source file can be either remote or local file.</td></tr> <tr><td>source-context</td> <td style="text-align:center;">-</td> <td style="text-align:center;">No</td> <td>The key-value mapping to compile the source file if it is a Jinja2 template</td></tr> <tr><td>context-lines</td> <td style="text-align:center;">0</td> <td style="text-align:center;">No</td> <td>Specify the number context lines around the line changes in the diff</td></tr> <tr><td>ignore-missing</td> <td style="text-align:center;">false</td> <td style="text-align:center;">No</td> <td>Specify whether a missing target file is a fail</td></tr></tbody></table> <h4 id="example-2"><a href="#example-2" class="header-anchor">#</a> Example</h4> <p><code>https://github.com/test/repo/raw/master/source-file.txt</code>:</p> <div class="language- extra-class"><pre class="language-text"><code>This is file #{{ VERSION }}.
</code></pre></div><p><code>target-file.txt</code>:</p> <div class="language- extra-class"><pre class="language-text"><code>This is file #2.
</code></pre></div><p>Shipshape check:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">filediff</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;Validate against source file&quot;</span>
    <span class="token key atrule">source</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/test/repo/raw/master/source<span class="token punctuation">-</span>file.txt
    <span class="token key atrule">target</span><span class="token punctuation">:</span> target<span class="token punctuation">-</span>file.txt
    <span class="token key atrule">ignore-missing</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">context-lines</span><span class="token punctuation">:</span> <span class="token number">0</span>
    <span class="token key atrule">severity</span><span class="token punctuation">:</span> low
    <span class="token key atrule">source-context</span><span class="token punctuation">:</span>
      <span class="token key atrule">VERSION</span><span class="token punctuation">:</span> <span class="token number">1</span>
</code></pre></div><p>Result:</p> <div class="language- extra-class"><pre class="language-text"><code># Breaches were detected

  ### Validate against source file
     -- [Target file target-file.txt is different from Source file https://github.com/test/repo/raw/master/source-file.txt] diff: 
--- https://github.com/test/repo/raw/master/source-file.txt
+++ target-file.txt
@@ -1 +1 @@
-This is file #1.
+This is file #2.
</code></pre></div><h3 id="yaml"><a href="#yaml" class="header-anchor">#</a> yaml</h3> <p>Checks yaml files for the presence or absence of required/disallowed values.</p> <table><thead><tr><th>Field</th> <th style="text-align:center;">Default</th> <th style="text-align:center;">Required</th> <th>Description</th></tr></thead> <tbody><tr><td>path</td> <td style="text-align:center;">-</td> <td style="text-align:center;">Yes</td> <td>Path (directory) to check for the presence of files</td></tr> <tr><td>file</td> <td style="text-align:center;">-</td> <td style="text-align:center;">No</td> <td>A single file to check</td></tr> <tr><td>files</td> <td style="text-align:center;">-</td> <td style="text-align:center;">No</td> <td>A list of files to check</td></tr> <tr><td>pattern</td> <td style="text-align:center;">-</td> <td style="text-align:center;">No</td> <td>Regex pattern defining a list of files to check</td></tr> <tr><td>exclude-pattern</td> <td style="text-align:center;">-</td> <td style="text-align:center;">No</td> <td>Regex pattern to exclude a list of files from the check</td></tr> <tr><td>ignore-missing</td> <td style="text-align:center;">false</td> <td style="text-align:center;">No</td> <td>Specify whether a missing file is a fail</td></tr> <tr><td>values</td> <td style="text-align:center;">-</td> <td style="text-align:center;">Yes</td> <td>The list of keys and values for the check.</td></tr> <tr><td>optional</td> <td style="text-align:center;">-</td> <td style="text-align:center;">No</td> <td>If set,  the validation will not fail if the key is not present</td></tr></tbody></table> <h4 id="values"><a href="#values" class="header-anchor">#</a> Values</h4> <p>The list of values can either be simple key/value, e.g</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">values</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> foo
    <span class="token key atrule">value</span><span class="token punctuation">:</span> bar
</code></pre></div><p>where the file being checked is:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token comment"># file-being-checked.yml</span>
<span class="token key atrule">a</span><span class="token punctuation">:</span> b
<span class="token key atrule">foo</span><span class="token punctuation">:</span> bar
<span class="token key atrule">c</span><span class="token punctuation">:</span> d
</code></pre></div><p>in which case line <code>foo: bar</code> would be detected as a breach.</p> <p>Or it can be a list of disallowed values, e.g</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">values</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> foo
    <span class="token key atrule">is-list</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">disallowed</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> zoo
      <span class="token punctuation">-</span> zoom
      <span class="token punctuation">-</span> paf
</code></pre></div><p>where the file being checked is:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token comment"># file-being-checked.yml</span>
<span class="token key atrule">a</span><span class="token punctuation">:</span> b
<span class="token key atrule">foo</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> bar
  <span class="token punctuation">-</span> baz
  <span class="token punctuation">-</span> zoo
  <span class="token punctuation">-</span> zoom
<span class="token key atrule">c</span><span class="token punctuation">:</span> d
</code></pre></div><p>in which case lines <code>- zoo</code> and <code>- zoom</code> would be detected as breaches.</p> <h4 id="example-3"><a href="#example-3" class="header-anchor">#</a> Example</h4> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">yaml</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Validate install profile
    <span class="token key atrule">file</span><span class="token punctuation">:</span> core.extension.yml
    <span class="token key atrule">ignore-missing</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">path</span><span class="token punctuation">:</span> config/default
    <span class="token key atrule">values</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> profile
        <span class="token key atrule">value</span><span class="token punctuation">:</span> govcms
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Disallowed permissions
    <span class="token key atrule">pattern</span><span class="token punctuation">:</span> user.role.<span class="token important">*.yml</span>
    <span class="token key atrule">exclude-pattern</span><span class="token punctuation">:</span> user.role.govcms_site_administrator
    <span class="token key atrule">ignore-missing</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">path</span><span class="token punctuation">:</span> config/default
    <span class="token key atrule">values</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> is_admin
        <span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
      <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> permissions
        <span class="token key atrule">is-list</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">disallowed</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> administer modules
          <span class="token punctuation">-</span> administer permissions
          <span class="token punctuation">-</span> administer site configuration
          <span class="token punctuation">-</span> administer software updates
          <span class="token punctuation">-</span> Administer the list of modules that can be managed by others
          <span class="token punctuation">-</span> import configuration
          <span class="token punctuation">-</span> use PHP for google analytics tracking visibility
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Validate TFA config
    <span class="token key atrule">file</span><span class="token punctuation">:</span> tfa.settings.yml
    <span class="token key atrule">ignore-missing</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">path</span><span class="token punctuation">:</span> config/default
    <span class="token key atrule">values</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> enabled
        <span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token number">1</span>
      <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> required_roles.authenticated
        <span class="token key atrule">value</span><span class="token punctuation">:</span> authenticated
</code></pre></div><h3 id="yamllint"><a href="#yamllint" class="header-anchor">#</a> yamllint</h3> <p>documentation coming soon...</p> <h3 id="json"><a href="#json" class="header-anchor">#</a> json</h3> <p>Checks JSON files for the presence or absence of required/disallowed values.</p> <table><thead><tr><th>Field</th> <th style="text-align:center;">Default</th> <th style="text-align:center;">Required</th> <th>Description</th></tr></thead> <tbody><tr><td>path</td> <td style="text-align:center;">-</td> <td style="text-align:center;">Yes</td> <td>Path (directory) to check for the presence of files</td></tr> <tr><td>file</td> <td style="text-align:center;">-</td> <td style="text-align:center;">No</td> <td>A single file to check</td></tr> <tr><td>files</td> <td style="text-align:center;">-</td> <td style="text-align:center;">No</td> <td>A list of files to check</td></tr> <tr><td>pattern</td> <td style="text-align:center;">-</td> <td style="text-align:center;">No</td> <td>Regex pattern defining a list of files to check</td></tr> <tr><td>exclude-pattern</td> <td style="text-align:center;">-</td> <td style="text-align:center;">No</td> <td>Regex pattern to exclude a list of files from the check</td></tr> <tr><td>ignore-missing</td> <td style="text-align:center;">false</td> <td style="text-align:center;">No</td> <td>Specify whether a missing file is a fail</td></tr> <tr><td>key-values</td> <td style="text-align:center;">-</td> <td style="text-align:center;">Yes</td> <td>The list of keys and values for the check.</td></tr></tbody></table> <h4 id="key-values"><a href="#key-values" class="header-anchor">#</a> Key Values</h4> <p>The list of values can either be simple key/value pairs, e.g</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">key-values</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> $.license
    <span class="token key atrule">value</span><span class="token punctuation">:</span> GPL
  <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> repositories.package1.type
    <span class="token key atrule">value</span><span class="token punctuation">:</span> library
</code></pre></div><p>where the file being checked is:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;license&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BSD&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;repositories&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;package1&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vcs&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://github.com/package1&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>in which case line <code>license: BSD</code> and <code>type: vcs</code> would be detected as a breach.</p> <p>The <code>key</code> can be either a <a href="https://goessner.net/articles/JsonPath/index.html" target="_blank" rel="noopener noreferrer">JSONPath<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or
a <a href="https://jmespath.org/specification.html" target="_blank" rel="noopener noreferrer">JMESPath<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> expression. If the specified <code>key</code> doesn't present in the JSON file,
the validation will fail. The <code>optional</code> field could be set to <code>true</code> so that the validation will not fail if the key
does not present:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">key-values</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> $.authors
    <span class="token key atrule">value</span><span class="token punctuation">:</span> Anything
    <span class="token key atrule">optional</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre></div><p>If the <code>key</code> expression resolves to a list of values, the field <code>is-list</code> must be set to <code>true</code> so that the validation
will not fail.</p> <p>Instead of checking against a single <code>value</code>, it can be a list of disallowed values, e.g</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">key-values</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> <span class="token string">'$.repositories..type'</span>
    <span class="token key atrule">is-list</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">disallowed-values</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> package
      <span class="token punctuation">-</span> composer<span class="token punctuation">-</span>plugin 
</code></pre></div><p>or a list of allowed values, eg.</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">key-values</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> <span class="token string">'$.repositories..type'</span>
    <span class="token key atrule">is-list</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">allowed-values</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> vcs
      <span class="token punctuation">-</span> library 
</code></pre></div><p>where the file being checked is:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;license&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BSD&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;repositories&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;package1&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vcs&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://github.com/package1&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;no-api&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;package2&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;composer-plugin&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://github.com/package2&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;package3&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;package&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://github.com/package3&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;no-api&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>in which case lines <code>type: composer-plugin</code> and <code>type: package</code> would be detected as breaches.</p> <h4 id="example-4"><a href="#example-4" class="header-anchor">#</a> Example</h4> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">json</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Validate composer.json
    <span class="token key atrule">file</span><span class="token punctuation">:</span> composer.json
    <span class="token key atrule">ignore-missing</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">key-values</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> license
        <span class="token key atrule">optional</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">value</span><span class="token punctuation">:</span> MIT
      <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> <span class="token string">'$.repositories..no-api'</span>
        <span class="token key atrule">optional</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">is-list</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">disallowed-values</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token boolean important">true</span>
          <span class="token punctuation">-</span> <span class="token string">&quot;true&quot;</span>
          <span class="token punctuation">-</span> <span class="token number">1</span>
          <span class="token punctuation">-</span> <span class="token string">&quot;1&quot;</span>
        <span class="token key atrule">allowed-values</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token boolean important">false</span>
          <span class="token punctuation">-</span> <span class="token string">&quot;false&quot;</span>
          <span class="token punctuation">-</span> <span class="token number">0</span>
          <span class="token punctuation">-</span> <span class="token string">&quot;0&quot;</span>
          <span class="token punctuation">-</span>
</code></pre></div><h3 id="crawler"><a href="#crawler" class="header-anchor">#</a> crawler</h3> <p>documentation coming soon...</p> <h3 id="drush-yaml"><a href="#drush-yaml" class="header-anchor">#</a> drush-yaml</h3> <p>documentation coming soon...</p> <h3 id="drupal-file-module"><a href="#drupal-file-module" class="header-anchor">#</a> drupal-file-module</h3> <p>documentation coming soon...</p> <h3 id="drupal-db-module"><a href="#drupal-db-module" class="header-anchor">#</a> drupal-db-module</h3> <p>documentation coming soon...</p> <h3 id="drupal-db-permissions"><a href="#drupal-db-permissions" class="header-anchor">#</a> drupal-db-permissions</h3> <p>documentation coming soon...</p> <h3 id="drupal-role-permissions"><a href="#drupal-role-permissions" class="header-anchor">#</a> drupal-role-permissions</h3> <p>Checks for permissions of a specific role.</p> <table><thead><tr><th>Field</th> <th style="text-align:center;">Default</th> <th style="text-align:center;">Required</th> <th>Description</th></tr></thead> <tbody><tr><td>rid</td> <td style="text-align:center;">-</td> <td style="text-align:center;">Yes</td> <td>Role ID, eg. authenticated</td></tr> <tr><td>required-permissions</td> <td style="text-align:center;">-</td> <td style="text-align:center;">No</td> <td>List of required permissions</td></tr> <tr><td>disallowed-permissions</td> <td style="text-align:center;">-</td> <td style="text-align:center;">No</td> <td>List of disallowed permissions</td></tr></tbody></table> <p>Examples:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">checks</span><span class="token punctuation">:</span>
  <span class="token key atrule">drupal-role-permissions</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">'[DATABASE] Authenticated role check'</span>
      <span class="token key atrule">severity</span><span class="token punctuation">:</span> high
      <span class="token key atrule">rid</span><span class="token punctuation">:</span> <span class="token string">'authenticated'</span>
      <span class="token key atrule">required-permissions</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token string">'setup own tfa'</span>
      <span class="token key atrule">disallowed-permissions</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token string">'administer users'</span>
</code></pre></div><h3 id="drupal-user-forbidden"><a href="#drupal-user-forbidden" class="header-anchor">#</a> drupal-user-forbidden</h3> <p>Checks if a forbidden user is active.</p> <table><thead><tr><th>Field</th> <th style="text-align:center;">Default</th> <th style="text-align:center;">Required</th> <th>Description</th></tr></thead> <tbody><tr><td>uid</td> <td style="text-align:center;">1</td> <td style="text-align:center;">No</td> <td>The User ID to check</td></tr></tbody></table> <p>Example:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">checks</span><span class="token punctuation">:</span>
  <span class="token key atrule">drupal-user-forbidden</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">'[DATABASE] Active user 1 check'</span>
      <span class="token key atrule">severity</span><span class="token punctuation">:</span> high
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">'[DATABASE] Active user 2 check'</span>
      <span class="token key atrule">severity</span><span class="token punctuation">:</span> medium
      <span class="token key atrule">uid</span><span class="token punctuation">:</span> <span class="token number">2</span>
</code></pre></div><h3 id="phpstan"><a href="#phpstan" class="header-anchor">#</a> phpstan</h3> <p>documentation coming soon...</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/shipshape/assets/js/app.70d73435.js" defer></script><script src="/shipshape/assets/js/2.4470ce03.js" defer></script><script src="/shipshape/assets/js/1.185b50a8.js" defer></script><script src="/shipshape/assets/js/25.3a23e82c.js" defer></script>
  </body>
</html>
