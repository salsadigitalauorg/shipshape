package breach_test

import (
	"testing"

	"github.com/stretchr/testify/assert"

	. "github.com/salsadigitalauorg/shipshape/pkg/breach"
	"github.com/salsadigitalauorg/shipshape/pkg/remediation"
	"github.com/salsadigitalauorg/shipshape/pkg/remediation/testdata"
)

// Code generated by breach-type --type=Value,KeyValue,KeyValues; DO NOT EDIT.
// The proper way to update this file is to
//   - modify one of the pkg/breach/*_gen_test.go files as needed,
//   - copy the changes to pkg/breach/templates/breachtype_test.go.tmpl,
//   - replace the breach type struct name with \{\{ $breachType }} wherever needed.

{{ range $breachType := .BreachTypes -}}
func Test{{ $breachType }}BreachGetters(t *testing.T) {
	instance := {{ $breachType }}Breach{
		CheckName:         "breachTestCheck",
		CheckType:         "yaml",
		Severity:          "high",
		RemediationResult: remediation.RemediationResult{Status: remediation.RemediationStatusSuccess},
	}
	instance.SetRemediator(&testdata.TestRemediator{})

	assert := assert.New(t)
	assert.Equal("breachTestCheck", instance.GetCheckName())
	assert.Equal("yaml", instance.GetCheckType())
	assert.Equal("high", instance.GetSeverity())
	assert.Equal(&testdata.TestRemediator{}, instance.GetRemediator())
	assert.Equal(
		&remediation.RemediationResult{Status: remediation.RemediationStatusSuccess},
		instance.GetRemediationResult())
}

{{ end }}
