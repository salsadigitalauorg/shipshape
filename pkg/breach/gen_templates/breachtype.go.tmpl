package breach

import "github.com/salsadigitalauorg/shipshape/pkg/remediation"

// Code generated by breach-type --type=Value,KeyValue,KeyValues; DO NOT EDIT.

{{ range $breachType := .BreachTypes -}}
/*
 * {{ $breachType }}Breach
 */
func (b *{{ $breachType }}Breach) GetCheckName() string {
	return b.CheckName
}

func (b *{{ $breachType }}Breach) GetCheckType() string {
	return b.CheckType
}

func (b *{{ $breachType }}Breach) GetRemediator() remediation.Remediator {
	return b.remediator
}

func (b *{{ $breachType }}Breach) GetRemediationResult() *remediation.RemediationResult {
	return &b.RemediationResult
}

func (b *{{ $breachType }}Breach) GetSeverity() string {
	return b.Severity
}

func (b *{{ $breachType }}Breach) GetType() BreachType {
	return BreachType{{ $breachType }}
}

func (b *{{ $breachType }}Breach) SetCommonValues(checkType string, checkName string, severity string) {
	b.BreachType = b.GetType()
	b.CheckType = checkType
	b.CheckName = checkName
	b.Severity = severity
}

func (b *{{ $breachType }}Breach) SetRemediator(r remediation.Remediator) {
	b.remediator = r
}

func (b *{{ $breachType }}Breach) PerformRemediation() {
	if b.remediator == nil {
		b.RemediationResult = remediation.RemediationResult{
			Status: remediation.RemediationStatusNoSupport,
		}
		return
	}
	b.RemediationResult = b.remediator.Remediate()
}

func (b *{{ $breachType }}Breach) SetRemediation(status remediation.RemediationStatus, msg string) {
	b.RemediationResult.Status = status
	if msg != "" {
		b.RemediationResult.Messages = []string{msg}
	}
}

{{ end }}
